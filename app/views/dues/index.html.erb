<% flash.each do |type, msg| %>
<% if type=='notice'%>
    <div class="text-center full-bg bg-success m-0">
        <p class="text-white m-0"><%=msg%></p>
    </div>
<%end%>
<% end %>

<div class="jumbotron text-center">
    <h1 class="display-3">Dues Payments</h1>
    <%= link_to("Add Dues Payment", new_due_path, :class => 'action new large-link') %>
</div>

<div class="container text-center">
  <th>Filter Semester: </th>
  <td><%= select_tag(:chosen_semester, options_for_select(Semester.order("start_date DESC").map{ |s| [ s.semester_name, s.id ] }.insert(0,"All"), :selected => @selectedSemester),
	:onchange => "window.location.href = '/dues?semester=' + document.getElementById('chosen_semester').value", :class => "custom-select w-auto") %></td><br><br>


  <% if @selectedSemester != 'All'%>
    <th>Total = $<%= @total %></th><br><br>
  <% end %>
</div>

<div class="container text-center">
    <table class="table table-hover table-striped table-bordered" summary="Payment List">
        <thead class="thead-dark">
            <tr>
            <th>#</th>
            <th>Member</th>
            <th>Semester</th>
            <th>Amount</th>
            <th>Date</th>
            <th><i class="fas fa-edit"></i></th>
            <th><i class="fas fa-trash"></th>
            </tr>
        </thead>
        <% @payments.each_with_index do |payment, index| %>
        <tr>
            <td><a href="<%= due_path(payment) %>" class="cell-link"><%=index + 1%></a></td>
            <td><%= payment.member.name %></td>
            <td><%= payment.semester_1.semester_name%>
			    <% if payment.semester_id_2 != nil %>
				  <%=", " + payment.semester_2.semester_name %>
				<% end %>
			</td>
            <td>$ <%= payment.payment_amount %></td>
            <td><%= payment.payment_date.strftime('%b %d, %Y') %></td>
             <td>
                <%= link_to edit_due_path(payment), :class => 'action edit' do%>
                <i class="fas fa-edit"></i>
                <% end%>
            </td>
            <td>
                <%= link_to due_path(payment), method: :delete, data: {confirm: "Are you sure you wish to delete this dues payment?"} do%>
                <i class="fas fa-trash text-danger"></i>
                <% end%>
            </td>
        </tr>
        <% end %>
    </table>

</div>
